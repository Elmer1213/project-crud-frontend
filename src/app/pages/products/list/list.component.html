<div class="products-container">
  
  <!-- Header Card -->
  <div class="header-card">
    <div class="header-content">
      <div class="header-title">
        <span class="icon">ğŸ“¦</span>
        <h1>Lista de Productos</h1>
      </div>
      <button class="btn-primary" routerLink="/products/create">
        <span class="btn-icon">â•</span>
        Nuevo Producto
      </button>
    </div>
  </div>

  <!-- Barra de Filtros -->
  <div *ngIf="!loading && products.length > 0" class="filters-card">

    <!-- BÃºsqueda -->
    <div class="search-container">
      <div class="search-input-wrapper">
        <span class="search-icon">ğŸ”</span>
        <input 
          type="text" 
          class="search-input"
          placeholder="Buscar por nombre o descripciÃ³n..."
          [value]="searchTerm"
          (input)="onSearch($event)">

        <!-- BotÃ³n limpiar bÃºsqueda -->
        <button 
          *ngIf="searchTerm" 
          class="clear-search-btn"
          (click)="clearSearch()"
          title="Limpiar bÃºsqueda">
          âœ•
        </button>
      </div>
    </div>

    <!-- Botones de Ordenamiento -->
    <div class="sort-buttons-container">
      <span class="sort-label">Ordenar por:</span>
      
      <div class="sort-buttons">

        <!-- Ordenar por Nombre a-Z -->
        <button 
          class="sort-btn"
          [class.active]="currentSort === 'name-asc'"
          (click)="applySorting('name-asc')"
          title="Nombre A-Z">
          <span class="sort-icon">ğŸ”¤</span>
          <span class="sort-text">A â†’ Z</span>
        </button>

        <button 
          class="sort-btn"
          [class.active]="currentSort === 'name-desc'"
          (click)="applySorting('name-desc')"
          title="Nombre Z-A">
          <span class="sort-icon">ğŸ”¤</span>
          <span class="sort-text">Z â†’ A</span>
        </button>

        <!-- Ordenar por Precio -->
        <button 
          class="sort-btn"
          [class.active]="currentSort === 'price-asc'"
          (click)="applySorting('price-asc')"
          title="Precio menor a mayor">
          <span class="sort-icon">ğŸ’²</span>
          <span class="sort-text">$ â†‘</span>
        </button>

        <button 
          class="sort-btn"
          [class.active]="currentSort === 'price-desc'"
          (click)="applySorting('price-desc')"
          title="Precio mayor a menor">
          <span class="sort-icon">ğŸ’²</span>
          <span class="sort-text">$ â†“</span>
        </button>

        <!-- Ordenar por Fecha -->
        <button 
          class="sort-btn"
          [class.active]="currentSort === 'date-asc'"
          (click)="applySorting('date-asc')"
          title="MÃ¡s antiguos primero">
          <span class="sort-icon">ğŸ“…</span>
          <span class="sort-text">â†‘ Antiguo</span>
        </button>

        <button 
          class="sort-btn"
          [class.active]="currentSort === 'date-desc'"
          (click)="applySorting('date-desc')"
          title="MÃ¡s recientes primero">
          <span class="sort-icon">ğŸ“…</span>
          <span class="sort-text">â†“ Reciente</span>
        </button>

        <!-- Limpiar Filtros -->
        <button 
          class="sort-btn clear-btn"
          (click)="clearFilters()"
          *ngIf="searchTerm || currentSort !== 'none'"
          title="Limpiar filtros">
          <span class="sort-icon">ğŸ”„</span>
          <span class="sort-text">Limpiar</span>
        </button>
      </div>
    </div>

    <!-- Contador de resultados -->
    <div class="results-counter" *ngIf="searchTerm || currentSort !== 'none'">
      <span class="counter-text">
        Mostrando <strong>{{ filteredProducts.length }}</strong> de <strong>{{ products.length }}</strong> productos
      </span>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="state-card loading-state">
    <div class="spinner"></div>
    <p>Cargando productos...</p>
  </div>

  <!-- Empty State -->
  <div *ngIf="!loading && products.length === 0" class="state-card empty-state">
    <span class="state-icon">ğŸ“­</span>
    <h3>No hay productos registrados</h3>
    <p>Comienza agregando tu primer producto</p>
  </div>

  <!-- No Results State -->
  <div *ngIf="!loading && products.length > 0 && filteredProducts.length === 0" class="state-card empty-state">
    <span class="state-icon">ğŸ”</span>
    <h3>No se encontraron resultados</h3>
    <p>Intenta con otros tÃ©rminos de bÃºsqueda</p>
    <button class="btn-primary" (click)="clearFilters()" style="margin-top: 16px;">
      Limpiar filtros
    </button>
  </div>

  <!-- Products Table -->
  <div *ngIf="!loading && filteredProducts.length > 0" class="table-card">
    <div class="table-wrapper">
      <table class="products-table">
        <thead>
          <tr>
            <th class="col-id">ID</th>
            <th class="col-name">Nombre</th>
            <th class="col-description">DescripciÃ³n</th>
            <th class="col-price">Precio</th>
            <th class="col-date">Fecha CreaciÃ³n</th>
            <th class="col-actions">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let p of paginatedProducts" class="product-row">
            <td data-label="ID" class="cell-id">
              <span class="id-badge">{{ p.id }}</span>
            </td>
            <td data-label="Nombre" class="cell-name">
              <span class="product-name">{{ p.name }}</span>
            </td>
            <td data-label="DescripciÃ³n" class="cell-description">
              {{ p.description }}
            </td>
            <td data-label="Precio" class="cell-price">
              <span class="price-tag">${{ p.price }}</span>
            </td>
            <td data-label="Fecha" class="cell-date">
              {{ p.created_at ? (p.created_at | date:'short') : 'â€”' }}
            </td>
            <td data-label="Acciones" class="cell-actions">
              <div class="action-buttons">
                <button class="btn-edit" [routerLink]="['/products/edit', p.id]">
                  <span class="btn-icon">âœï¸</span>
                  <span class="btn-text">Editar</span>
                </button>
                <button class="btn-delete" (click)="deleteProduct(p.id)">
                  <span class="btn-icon">ğŸ—‘ï¸</span>
                  <span class="btn-text">Eliminar</span>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- PAGINACIÃ“N -->
    <div class="pagination-container">
      <div class="pagination-info">
        <span class="records-info">
          Mostrando {{ (currentPage - 1) * itemsPerPage + 1 }} - 
          {{ Math.min(currentPage * itemsPerPage, filteredProducts.length) }} 
          de {{ filteredProducts.length }} productos
        </span>
        
        <select 
          [value]="itemsPerPage" 
          (change)="onItemsPerPageChange($event)" 
          class="items-per-page-select">
          <option *ngFor="let option of itemsPerPageOptions" [value]="option">
            {{ option }} por pÃ¡gina
          </option>
        </select>
      </div>

      <div class="pagination-controls">
        <button 
          (click)="goToPage(1)" 
          [disabled]="currentPage === 1"
          class="pagination-btn"
          title="Primera pÃ¡gina">
          â®ï¸
        </button>
        
        <button 
          (click)="goToPage(currentPage - 1)" 
          [disabled]="currentPage === 1"
          class="pagination-btn"
          title="Anterior">
          â—€ï¸
        </button>

        <button 
          *ngFor="let page of getPageNumbers()"
          (click)="goToPage(page)"
          [class.active]="page === currentPage"
          class="pagination-btn page-number">
          {{ page }}
        </button>

        <button 
          (click)="goToPage(currentPage + 1)" 
          [disabled]="currentPage === totalPages"
          class="pagination-btn"
          title="Siguiente">
          â–¶ï¸
        </button>
        
        <button 
          (click)="goToPage(totalPages)" 
          [disabled]="currentPage === totalPages"
          class="pagination-btn"
          title="Ãšltima pÃ¡gina">
          â­ï¸
        </button>
      </div>
    </div>

  </div>

</div>